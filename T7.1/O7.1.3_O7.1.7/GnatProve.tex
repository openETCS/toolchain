\chapter{GNATprove}

\begin{description}
\item[\textcolor{green}{Author}] Author of the approaches description
  David Mentré (Mitsubishi Electric R\&D Centre Europe)
\item[\textcolor{blue}{Assessor 1}] First assessor of the approaches \todo{Name - Company}
\item[\textcolor{magenta}{Assessor 2}] Second assessor of the approaches Matthias Gudemann (Systerel)
\end{description}

In the sequel, main text is under the responsibilities of the author.

\begin{author_comment}
Author can add comments using this format at any place.
\end{author_comment}

\begin{assessor1}
First assessor can add comments using this format at any place.
\end{assessor1}

\begin{assessor2}
Second assessor can add comments using this format at any place.
\end{assessor2}

When a note is required, please follow this list :
\begin{description}
\item[0] not recommended, not adapted, rejected
\item[1] weakly recommended, adapted after major improvements, weakly rejected
\item[2] recommended, adapted (with light improvements if necessary)  weakly accepted
\item[3] highly recommended, well adapted,strongly accepted
\item[*] difficult to evaluate with a note (please add a comment under the table)
\end{description}

All the notes can be commented under each table.

\section{Presentation}

This section gives a quick presentation of the approach and the tool.

\begin{description}
\item[Name] Ada 2012 language with GNATprove tool
\item[Web site] \url{http://www.open-do.org/projects/hi-lite/gnatprove/}
\item[Licence] GNU GPL
\end{description}

\paragraph{Abstract} Part of the Hi-Lite project, GNATprove is a
formal verification tool for Ada, based on the GNAT compiler. It can
prove that subprograms respect their contracts, expressed as
preconditions and postconditions in the syntax of Ada 2012. The tool
automatically discovers the subset of subprograms which can be
formally analyzed. GNATprove is currently available for x86 linux, x86
windows and x86-64 linux.

The GNATprove tool can be combined with regular testing tools to cover
the whole program using the most efficient approaches.


\paragraph{Publications}
\begin{itemize}
\item Hi-Lite: The Convergence of Compiler Technology and Program
  Verification
  \url{http://www.open-do.org/wp-content/uploads/2012/11/HILT_2012.pdf} 
\item Integrating Formal Program Verication with \url{Testing
  http://www.open-do.org/wp-content/uploads/2011/12/hi-lite-erts2012.pdf}
\end{itemize}



\section{Main usage of the approach}
\label{main_usage}
This section discusses the main usage of the approach.

According to the figure \ref{fig:main_process}, for which phases do you recommend the approach (give a note from 0 to  3) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
System Analysis & 1 & & 1 &  \\
\hline
Sub-system formal design & 2 & & 1 & \\
\hline
Software design & 3 & & 3 & \\
\hline
Software code generation & 3 & & 3 & \\
\hline
\end{tabular}

According to the figure \ref{fig:main_process}, for which type of activities do you recommend the approach (give a note from 0 to  3) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Documentation & 1 & & 1 &  \\
\hline
Modeling & 1 & & 1 &  \\
\hline
Design & 2 & & 1 & \\
\hline
Code generation & 3 & & 3 & \\
\hline
Verification & 3 & & 3 & \\
\hline
Validation & 3 & & 3 & \\
\hline
Safety analyses & 1 & & 1 & \\
\hline
\end{tabular}

\paragraph{Known usages} Have you some examples of usage of this approach to  compare with the OpenETCS objectives?

Ada (and its SPARK variant) are used for avionics DO-178B
projects, EN50128 railway projects (Alstom, Siemens, ...), ...

\section{Language}
This section discusses the main element of the language.

Which are the main characteristics of the language :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Informal language & 0 & & 0 &  \\
\hline 
Semi-formal language & 0 & & 0 &  \\
\hline
Formal language & 3 & & 3 &  \\
\hline
Structured language & 3 & & 3 & \\
\hline
Modular language & 3 & & 3 & \\
\hline
Textual language & 3 & & 3 & \\
\hline
Mathematical symbols or code & 3 & & 3 & \\
\hline
Graphical language & 0 & & 0 & \\
\hline
\end{tabular}

According WP2 requirements, give a note for the capabilities of the language (from 0 to 3) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Declarative formalization of properties (D.2.6-X-28) & 3 & & 3 & \\
\hline
Simple formalization of properties (D.2.6-X-28.1) & 2 & & 2 & \\
\hline
Scalability : capability to design large model & 3 & & 3 & \\
\hline
Easily translatable to other languages (D.2.6-X-30) & 2 & & 2 & \\
\hline
Executable directly (D.2.6-X-33) & 3 & & 3 & \\
\hline
Executable after translation to a code (D.2.6-X-33) & 3 & & 3* & \\
(precise if the translation is automatic) & 3\footnote{No translation needed.} & & & \\
\hline
Simulation, animation (D.2.6-X-33) & 1 & & 2* & \\
\hline
Easily understandable (D.2.6-X-27) & 2 & & 2 & \\
\hline
Expertise level needed (0 High level, 3 few level) & 2 & & 2 & \\
\hline
Standardization (D.2.6-X-29) & 3 & & 3 & \\
\hline
Documented (D.2.6-X-29) & 3 & & 3 & \\
\hline
Extensible language (D.2.6-01-28) & 3 & & 3 & \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} Executable after translation to a code is not
applicable, as it is directly executable code, i.e., no intermediate step is
needed for compilation.

Simulation, animation should be possible with the GNAT Visual Debugger.


\paragraph{Documentation} Describe how the language is documented, the existing guidelines, coding rules, standardization...

Ada 2012 is described in ISO/IEC 8652:2012 standard. It was developed
under USA's Department of Defense. Several documents describe coding
guidelines.


\paragraph{Language usage} Describe the possible restriction on the language

The Ada language is a general purpose programming language.

\textcolor{magenta}{Assessor 2} For GNATprove / SPARK 2014, only a subset of
full Ada can be used, nevertheless this still represents a general purpose
programming language.

\section{System Analysis}
This section discusses the usage of the approach for system analysis.
It can be skipped depending the results of \ref{main_usage}.

According to WP2 requirements, how the approach can be involved for
the sub-system requirement specification?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Independent System functions definition (D.2.6-X-10.2.1)  & 1 & & 1 &  \\
\hline
System architecture design (D.2.6-X-10.2) & 2 & & 2 &  \\
\hline
System data flow identification (D.2.6-X-10.2.3)  & 2 & & 2 &  \\
\hline
Sub-system focus (D.2.6-X-10.2.4)  & 1 & & 1 &  \\
\hline
System interfaces definition (D.2.6-X-10.2.5)  & 2 & & 2 &  \\
\hline
System requirement allocation (D.2.6-X-10.3)  & 0 & & 0 &  \\
\hline
Traceability with SRS (D.2.6-X-10.5)  & 1 & & 1 &  \\
\hline
Traceability with Safety activities (D.2.6-X-11)  & 2 & & 2 &  \\
\hline
\end{tabular}



\section{Sub-System formal design}
This section discusses the usage of the approach for sub-system formal design.
It can be skipped depending the results of \ref{main_usage}.

Two kinds of model can be planned during this phase: semi-formal models to  cover the SSRS (D.2.6-X-12.1) and strictly formal  models to  focuss on some functional and safety aspects (D.2.6-X-14).  Obviously some strictly  formal means can be used to define the semi-formal  model.

\subsection{Semi-formal model}

Concerning semi-formal model, how the WP2 requirements are covered?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Consistency to SSRS (D.2.6-X-12.2) & 2 & & 2 &  \\
\hline
Coverage of SSRS (D.2.6-X-12.2.1)  & 3 & & 2 &  \\
\hline
Coverage of SSHA (D.2.6-X-12.2.2)  & 2 & & 2 &  \\
\hline
Management of requirement justification (D.2.6-X-12.2.3)  & 0 & & 0 &  \\
\hline
Traceability to  SSRS (D.2.6-X-12.2.5)  & 1 & & 1 &  \\
\hline
Traceability of exported requirements (D.2.6-X-12.2.6)  & 1 & & 1 &  \\
\hline
Simulation or animation (D.2.6-X-13 partial)  & 3 & & 3 &  \\
\hline
Execution (D.2.6-X-13 partial)  & 3 & & 3 &  \\
\hline
Extensible to strictly formal model (D.2.6-X-14.3) & 3 & & 3 &  \\
\hline
Easy to  refine towards strictly formal model (D.2.6-X-14.4) & 3 & & 3 &  \\
\hline
Extensible and modular design (D.2.6-X-15)  & 3 & & 3 &  \\
\hline
Extensible to software architecture and design (D.2.6-X-30)   & 3 & & 3 &  \\
\hline
\end{tabular}

Concerning safety properties management, how the WP2 requirements are covered ?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Safety function isolation (D.2.6-X-17)  & 2 & & 2 &  \\
\hline 
Safety properties formalisation (D.2.6-X-22)  & 3 & & 2* &  \\
\hline
Logical expression (D.2.6-X-28.2.2)  & 3 & & 3 &  \\
\hline
Timing constraints (D.2.6-X-28.2.3)  & 1 & & 1 &  \\
\hline
Safety properties validation (D.2.6-X-23.2)  & 3 & & 2* &  \\
\hline
Logical properties assertion (D.2.6-X-34)  & 3 & & 3 &  \\
\hline
Check  of assertions (D.2.6-X-34.1)  & 3 & & 3 &  \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} Safety properties formalization and validation
is probably not easy if it cannot be reduced to pre-/ postconditions of a single
function. If several functions are concerned, I am not sure how it can be
assured that the conjunction of the post-conditions correctly implies a higher
level safety property.

Does the language allow to  formalize (D.2.6-X-31):

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
State machines  & 3 & & 3 &  \\
\hline
Time-outs  & 1 & & 1* &  \\
\hline
Truth tables  & 3 & & 3 &  \\
\hline
Arithmetic  & 3 & & 3 &  \\
\hline
Braking curves  & 3 & & 3 &  \\
\hline
Logical statements & 3 & & 3 &  \\
\hline
Message and fields & 3 & & 3 &  \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} Ada offers time-outs, is this not within the
subset supported by SPARK 2014?

\paragraph{Additional comments on semi-formal  model} Do you think your semi-formal  model is sufficient to cover a safe design of the on-board unit until code generation ?
All comments on links to  other models, validation and verification activities are welcomed.

It is possible to make a semi-formal model using Ada 2012 but this
approach is a bit far fetched for the approach.

\subsection{Strictly formal model}

Concerning strictly formal model, how the WP2 requirements are covered ?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Consistency to SFM (D.2.6-X-14.2) & 2 & & 2 &  \\
\hline
Coverage of SSRS (D.2.6-X-14.2)  & 3 & & 3 &  \\
\hline
Traceability to  SSRS (D.2.6-X-14.3)  & 1 & & 1 &  \\
\hline
Extensible to software design (D.2.6-X-16)  & 3 & & 3 &  \\
\hline
Safety function isolation (D.2.6-X-17)  & 3 & & 2 &  \\
\hline 
Safety properties formalisation (D.2.6-X-22)  & 3 & & 2 &  \\
\hline
Logical expression (D.2.6-X-28.2.2)  & 3 & & 3 &  \\
\hline
Timing constraints (D.2.6-X-28.2.3)  & 1 & & 1 &  \\
\hline
Safety properties validation (D.2.6-X-23.3)  & 3 & & 3 &  \\
\hline
Logical properties assertion (D.2.6-X-34)  & 3 & & 3 &  \\
\hline
Proof of assertions (D.2.6-X-34.2)  & 3 & & 3 &  \\
\hline
\end{tabular}

Does the language allow to  formalize (D.2.6-X-32):

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
State machines  & 3 & & 3 &  \\
\hline
Time-outs  & 1 & & 1 &  \\
\hline
Truth tables  & 3 & & 3 &  \\
\hline
Arithmetic  & 3 & & 3 &  \\
\hline
Braking curves  & 3 & & 3 &  \\
\hline
Logical statements & 3 & & 3 &  \\
\hline
Message and fields & 3 & & 3 &  \\
\hline
\end{tabular}

\paragraph{Additional comments on semi-formal  model} Do you think your strictly formal  model can be directly defined from the SSRS ?
All comments on links to  other models, validation and verification activities are welcomed.

Ada language is suitable to formalize a strictly formal model. As Ada
is a programming language, a design phase should probably be put
between the SSRS and the strictly formal model.

\section{Software design}
This section discusses the usage of the approach for software design.
It can be skipped depending the results of \ref{main_usage}.

\subsection{Functional design}

How the approach allows to  produce a functional software model of the on-board unit ?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Derivation from system semi-formal model  & 3 & & 3 &  \\
\hline 
Software architecture description  & 3 & & 2 &  \\
\hline
Software constraints  & 3 & & 3 &  \\
\hline
Traceability  & 1 & & 1 &  \\
\hline
Executable  & 3 & & 3 &  \\
\hline
\end{tabular}

\subsection{SSIL4 design}

How the approach allows to  produce in safety a software model ?

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Derivation from system semi-formal or strictly formal model  & 3 & & 3 &  \\
\hline 
Software architecture description  & 3 & & 3 &  \\
\hline
Software constraints  & 3 & & 3 &  \\
\hline
Traceability  & 1 & & 1 &  \\
\hline
Executable  & 3 & & 3 &  \\
\hline
Conformance to EN50128 § 7.2  & 1 & & 1 &  \\
\hline
Conformance to EN50128 § 7.3  & 3 & & 2 &  \\
\hline
Conformance to EN50128 § 7.4  & 3 & & 3 &  \\
\hline
\end{tabular}

Which criteria for software architecture are covered by the methodology
(see EN50128 table A.3) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Defensive programming  & 3 & & 3 &  \\
\hline 
Fault detection \& diagnostic  & 3 & & 3 &  \\
\hline
Error detecting code  & 3 & & 3 &  \\
\hline
Failure assertion programming & 3 & & 3 &  \\
\hline
Diverse programming & 3 & & 3 &  \\
\hline
Memorising executed cases & 3 & & 3 &  \\
\hline
Software error effect analysis & 1 & & 1 &  \\
\hline
Fully defined interface & 3 & & 3 &  \\
\hline
Modelling  & 2 & & 2&  \\
\hline
Structured methodology & 1 & & 1 &  \\
\hline
\end{tabular}

\section{Software code generation}
This section discusses the usage of the approach for software code generation.
It can be skipped depending the results of \ref{main_usage}.

Which criteria for software design and implementation are covered by the methodology
(see EN50128 table A.4) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline
Formal methods  & 3 & & 3 &  \\
\hline 
Modeling  & 1 & & 1 &  \\
\hline
Modular approach (mandatory) & 3 & & 3 &  \\
\hline
Components & 3 & & 3 &  \\
\hline
Design and coding standards (mandatory) & 3 & & 3 &  \\
\hline
Strongly typed programming language & 3 & & 3 &  \\
\hline

\end{tabular}



\section{Main usage of the tool}
\label{main_usage}

This section discusses the main usage of the tool.

Which task are covered by the tool ?


\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Modelling support & 1 & & 1 &  \\
\hline
Automatic translation  & - & & * & \\
\hline
Code Generation  & 3 & & 3 & \\
\hline
Model verification & 3 & & 3 & \\
\hline
Test generation & 2 & & 2 & \\
\hline
Simulation, execution, debugging & 3 & & 3 & \\
\hline
Formal proof & 3 & & 3* & \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} The formal proofs are made by using external
tools.

\paragraph{Modelling support}
Does the tool provide a  textual or a graphical editor ?

Textual editor.

\paragraph{Automatic translation and code generation}
Which translation or code generation is supported by the tool ?

Ada code is directly compilable to machine assembly.

\paragraph{Model verification}
Which verification on models are provided by the tool?

Any contract expressed in first order logic can be verified by the
tool.

\paragraph{Test generation}
Does the tool allow to generate tests ? For  which purpose ?

The tool allows to generate test benches. Tests themselves should be
generated manually.

\paragraph{Simulation, execution, debugging}
Does the tool allow to simulate or to debbug step by step a model or a code ?

Yes, tool as debugging facilities.

\paragraph{Formal proof}
Does the tool allow formal proof ?  How ?

Yes. Properties to verify are expressed as first order contracts and
code annotations (loops, assertions). An automatic prover can then be
used to prove those contracts and annotations.

\textcolor{magenta}{Assessor 2} How well are interactive proofs supported?

\section{Use of the tool}


According WP2 requirements, give a note for characteristics of the use of the tool (from 0 to 3) :

\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Open Source\textcolor{magenta}{Assessor 2} & Total \\ (D2.6-X-36) & 3 & & 2*&  \\
\hline 
Portability to operating systems (D2.6-X-37) & 3 & & 3 &  \\
\hline
Cooperation of tools (D2.6-X-38) & 3 & & 3 &  \\
\hline
Robustness (D2.6-X-41) & 3 & & 3 & \\
\hline
Modularity (D2.6-X-41.1) & 3 & & 3 & \\
\hline
Documentation management (D.2.6-X-41.2) & 3 & & 3 & \\
\hline
Distributed software development (D.2.6-X-41.3)  & 3 & & 3 & \\
\hline
Simultaneous multi-users (D.2.6-X-41.4)   & 3 & & 3 & \\
\hline
Issue tracking (D.2.6-X-41.5) & 0 & & 0 & \\
\hline
Differences between models (D.2.6-X-41.6) & 1* & & 2 & \\
\hline
Version management (D.2.6-X-41.7) & 0 & & 1* & \\
\hline
Concurrent version development (D.2.6-X-41.8) & 3 & & 3 & \\
\hline
Model-based version control (D.2.6-X-41.9) & - & & * & \\
\hline
Role traceability (D.2.6-X-41.10) & - & & & \\
\hline
Safety version traceability (D.2.6-X-41.11) & 3 & & 3 & \\
\hline
Model traceability (D.2.6-01-035) & 1 & & 1 & \\
\hline
Tool chain integration & 2 & & 2 & \\
\hline
Scalability & 3 & & 3 & \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} The tool is free only for non-commercial or free
software development.

The development tool GPS supports a visual file diff view and different version
management systems.

\section{Certifiability}

This section discusses how the tool can be classified according EN50128 requirements (D.2.6-X-50).


\begin{tabular}{|l | c | c | c | c|}
\hline
& \textcolor{green}{Author} & \textcolor{blue}{Assessor 1} & \textcolor{magenta}{Assessor 2} & Total \\
\hline 
Tool manual (D.2.6-01-42.02) & 3 & & 3 &  \\
\hline
Proof of correctness (D.2.6-01-42.03)   & ? & & * & \\
\hline
Existing industrial  usage  & 3 &  & 3 & \\
\hline
Model verification & 3 & & 3 & \\
\hline
Test generation & 1 & & * & \\
\hline
Simulation, execution, debugging & 2 & & 2 & \\
\hline
Formal proof & 3 & & 3 & \\
\hline
\end{tabular}

\textcolor{magenta}{Assessor 2} I did not look into test generation for
GNATprove / SPARK 2013 with the GPS tool.

\paragraph{Other elements for tool certification}


The Ada tool chain is used for certification of aeronautics D0178B
products and railway EN50128 products.

\section{Other comments}
Please to  give free comments on the approach.



